---
title: Regex 正则表达式
mathjax: false
tags:
  - Regex
categories:
  - 文本处理
date: 2018-08-10 16:24:09
---

# 正则表达式简介

正则表达式适用于匹配字符串.

正则表达式中拥有的元素有:

- 普通字符, 例如一般的 `abcd` 和 `中文字符` 等等.
- 元字符, 元字符起特殊作用, 如果要匹配元字符本身, 需要使用反斜杠 `\` 转义.

# 正则表达式

建议先用 python 写一个简单的正则判断器:

[我写了一个小东西](/assert/python/regex_test.py)

## 万用表达式:

- `.` 点号, 表示一个任意符号(除了换行符).

## 限定符

在正则表达式中, 有这样几个有用的元字符用于指定重复次数:

- `*` 星号, 限定前方的那个字符将会重复 0 次以上.
- `+` 加号, 限定前方的那个字符将会重复 1 次以上.
- `?` 问好, 限定前方的那个字符将会出现 1 次或 0 次.

用这些元字符, 可以起到更高级的通配符功能.

例如

```
colou?r 可以匹配 colour 或 color
wtf+    可以匹配 wtf, wtff, wtfff, ...
wtf*    则可以匹配 wt, wtf, wtff, wtfff, ...
而 .*   的组合可以匹配任意字符串.
```

还可以自定义重复次数, 这些表达式都和花括号有关:

- `{n}`         指定重复 n 次.
- `{m,}`        指定重复 m 次及以上.
- `{,n}`        指定重复 n 次及以内.
- `{m,n}`       指定重复 m 次到 n 次.

## 定位符

除此之外, 还需要了解一下这些用于定位字符串的元字符:

- `^` 表示一个字符串的开始.
- `$` 表示一个字符串的结束.

例如

```
test a text

^t 将会匹配 test 的第一个 t
t$ 将会匹配到 text 的最后一个 t
```

另外还有用于在字符串中定位单词的正则表达式:

- `\b` 匹配一个单词边界. 
如 `This is a high tower`, `hi\b` 将会匹配 `high` 中的 `hi`, 而 `This` 中的 `hi` 不会匹配
- `\B` 匹配一个非单词边界.

**不能将限定符用在定位符之后!!!**

## 子表达式相关

在一个正则表达式中, 可以嵌入子表达式. 有两种形式:

- `()`          在括号中的字符, 必须全部匹配, 才会匹配整个子表达式. 整个表达式作为一个字符串.
- `[]`          在括号中的字符, 只要存在一个匹配, 就会匹配整个子表达式. 整个表达式作为一个字符.

例如:

```
Common plain text in windows notepad
[win] 将会匹配所有的 w, i, n
(win) 只会匹配 windows 中的 "win"
```

# 在 Python 中使用 re 模块

`re` 模块中提供了两个最主要的函数:

- `match()` 用于检测目标字符串是否能被正则表达式匹配.
- `findall()` 用于搜索目标字符串中能被正则表达式匹配的内容, 并存储到一个列表中返回.

另外还有一些函数, 留待后文讲解.

# Regex 语法列表

|表达式|含义|备注|
|:-:|-|-|
|`\`|转义字符||
|`.`|任意字符(不包括换行符)|要匹配换行符, 使用 `[.\n]`|
|定位符|||
|`^`|字符串首|匹配字符串开始位置, 如果设置了 multiline, 也可匹配换行符之后的位置|
|`$`|字符串尾|匹配字符串结束位置, 如果设置了 multiline, 也可匹配换行符之前的位置|
|限制符|||
|`{}`|限制符|限制字符重复次数|
|`{n}`|字符正好出现 n 次||
|`{n,}`|字符至少出现 n 次||
|`{m,n}`|字符出现 m 到 n 次||
|`*`|字符出现 0 次或任意次|`{0,}`|
|`+`|字符至少出现一次|`{1,}`|
|`?`|字符出现 0 次或 1 次|`{0,1}`|
|`?`|贪婪设置符|当 `?` 紧跟某限制符时, 匹配使用非贪婪模式|
|字符集合|||
|`|`|表示"或"|这东西优先级不高|
|`()`|子字符集||
|`[]`|字符集合|表示包括其中字符|
|`[^]`|负值字符集合|不包括其中字符|
|`[-]`|字符范围|`[a-z]` 包括所有小写字母, 顺序按照 Unicode 排序(包含了 ASCII)|
|特殊元字符|||
|`\s`|任意数量的空白字符|如空格, 换行符等|
|`\S`|任意数量的可见字符|如普通字母, 汉字等|
|`\b`|匹配一个单词边界|如 `This is a high tower`, `hi\b` 将会匹配 `high` 中的 `hi`, 而 `This` 中的 `hi` 不会匹配|
|`\B`|匹配一个非单词边界||
|`\d`|匹配数字字符|等价于 `[0-9]`|
|`\D`|匹配非数字字符|等价于 `[^0-9]`|
|`\w`|匹配字母, 数字, 下划线|等价于 `[A-Za-z0-9_]`|
|`\W`|匹配非字母, 数字, 下划线|等价于 `[^A-Za-z0-9_]`|
|`\x`|匹配一个 16 进制编码字符, 使用 ASCII编码|例如 `\x048` 表示 `0`|
|`\u`|匹配一个 16 进制编码字符, 使用 Unicode编码||
|`\num`|引用前方获取的子表达式||
|`\c`|匹配 [控制字符](#值得在意的控制字符)|例如 `\cM` 匹配回车 `\r`(`Control-M`)|


## 值得在意的控制字符

- 换行符, `\n`, `control-J`
- 回车符, `\e`, `control-M`
- 换页符, `\f`, `control-L`